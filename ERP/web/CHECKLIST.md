# ERP 전체 작업 체크리스트

이 문서는 `ERP/web` 기준 운영 체크리스트입니다.

## 0) 고정 원칙
- [ ] 같은 회사(`company_id`) 사용자는 같은 데이터 범위를 공유한다.
- [ ] 회사 간 데이터는 절대 노출되지 않는다.
- [ ] 관리자 기능은 `requesterId` 기반 권한 검증을 통과해야 한다.
- [ ] 모든 텍스트/소스 파일은 UTF-8 인코딩을 유지한다.

## 1) 작업 시작 전 (안전장치)
- [ ] 현재 기준점 태그 생성: `git tag backup/dev-YYYYMMDD-HHmm`
- [ ] 작업 브랜치 생성: `git checkout -b fix/<작업명>`
- [ ] 변경 범위/목표를 1~3줄로 정의
- [ ] 영향 API/화면 목록 작성
- [ ] 복원 계획 확정 (아래 7번 기준)

### DB 안전장치
- [ ] Dev DB 스냅샷(백업 SQL/덤프) 확보
- [ ] 마이그레이션이 있으면 롤백 SQL도 같이 준비
- [ ] 환경변수(.env) 변경 시 변경 전 값 별도 보관

## 2) 구현 중 체크
- [ ] API 권한 검증 로직 추가/수정 시 모든 호출부 파라미터 동기화
- [ ] `DELETE/PUT`는 호출자 식별값(`requesterId` 또는 헤더) 누락 여부 확인
- [ ] `company` 스코프 필요한 API는 클라이언트 호출부 누락 여부 확인
- [ ] 에러 메시지는 사용자/운영자 관점에서 이해 가능하게 유지
- [ ] 기존 동작 회귀 위험이 있는 지점은 임시 로그 또는 디버그 포인트로 확인

## 3) 코드 검증 (개발자 체크)
- [ ] 변경 파일 목록 확인: `git diff --name-only`
- [ ] 영향 파일 정적 점검: `npx eslint <변경파일들>`
- [ ] 최소 빌드 확인: `npm run build`
- [ ] 실패 시 원인/재현방법/해결여부 기록

주의: 현재 프로젝트 전체 lint 누적 이슈가 있을 수 있으므로, 최소한 변경 파일 기준 검증은 반드시 남긴다.

## 4) 기능 QA (내부 사용자 관점)

### 공통
- [ ] 로그인/권한별 화면 접근 정상 동작
- [ ] 내 회사 데이터는 보이고, 타 회사 데이터는 보이지 않음
- [ ] 목록/상세/수정/삭제 후 즉시 새로고침 시 데이터 일관성 유지

### 사용자/관리자
- [ ] 관리자 전용 기능(사용자 목록, 승인, 삭제, 다운로드) 정상 동작
- [ ] 일반 사용자는 관리자 기능 호출 시 차단됨(403/401)
- [ ] 본인 계정 삭제와 타인 계정 삭제 권한 분리 확인

### 명함(Business Cards)
- [ ] 명함 목록 조회 시 `userId` 포함 조건에서 정상 조회
- [ ] 회사 스코프 공유: 같은 회사 구성원 간 데이터 조회 가능
- [ ] 삭제/즐겨찾기/수정 시 권한 검증 정상

### 매물(Properties)
- [ ] 삭제 시 `id + company` 스코프로만 삭제됨
- [ ] 담당자 변경 시 담당자 회사와 매물 회사 불일치 차단
- [ ] 대량 작업(여러 건 삭제/업로드) 시 일부 실패 처리 메시지 확인

## 5) 환경별 배포 체크 (Local -> Dev -> Prod)

### Local
- [ ] 기능 개발 완료
- [ ] 핵심 시나리오 수동 QA 완료

### Dev
- [ ] Dev 배포 후 동일 시나리오 재검증
- [ ] 실제 계정(관리자/일반)으로 권한 검증
- [ ] 성능/응답 지연/콘솔 에러 점검

### Prod
- [ ] 배포 윈도우/담당자/복구 담당자 확정
- [ ] 배포 직후 스모크 테스트 완료
- [ ] 문제 발생 시 즉시 롤백 실행 가능 상태 확인

## 6) 변경사항 공유 템플릿 (안티그래비티/협업 전달용)

### A. 변경 요약
- 작업명:
- 목적:
- 변경 파일:
- 핵심 로직 변화:

### B. 검증 증거
- 실행 명령:
- 결과 요약:
- 수동 QA 시나리오/결과:
- 남은 리스크:

### C. 사용자 영향
- 사용자에게 보이는 변경점:
- 사용 방법 변화:
- 주의사항:

## 7) 롤백 체크리스트 (문제 발생 시)
- [ ] 코드 롤백: 기준 태그/커밋으로 복귀
- [ ] DB 롤백: 사전 백업/롤백 SQL 실행
- [ ] 캐시/세션 영향 확인
- [ ] 재배포 후 스모크 테스트
- [ ] 장애 원인/재발방지 기록

## 8) 완료 정의 (Done)
- [ ] 코드 반영 완료
- [ ] 검증 로그/증거 확보
- [ ] 사용자 관점 영향 정리 완료
- [ ] 롤백 가능 상태 확인 완료
